#!/usr/bin/env ruby

GW_HOST=ARGV[0] || 'pstage57'
puts GW_HOST

SERVICE_PORTS=[
   8501, # config_service
   7161, #prefs
   2181, #zook keep
   8240, #credits
   6601, #payment
   5672, #rabbit
   8082, # inventory svc

]

PORT_FORWARD_ARGS=SERVICE_PORTS.map { |port|
  ['-L', "#{port}:localhost:#{port}"]
}

exec(*[%w{ssh -a -C -N -n}, PORT_FORWARD_ARGS, '-L 5433:localhost:5432', GW_HOST].flatten)

